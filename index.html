<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OB Cloud å…¨çƒåœ°åŸŸåˆ†å¸ƒ</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Three.js for 3D Globe -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- é«˜å¾·åœ°å›¾é…ç½® -->
    <script src="config.js"></script>
    <!-- åŠ¨æ€åŠ è½½é«˜å¾·åœ°å›¾ API -->
    <script>
        // Load é«˜å¾·åœ°å›¾ API with key from config.js
        (function() {
            if (typeof AMAP_API_KEY !== 'undefined' && AMAP_API_KEY !== 'YOUR_AMAP_KEY_HERE') {
                const script = document.createElement('script');
                script.src = `https://webapi.amap.com/maps?v=2.0&key=${AMAP_API_KEY}`;
                script.async = true;
                script.onload = function() {
                    console.log('é«˜å¾·åœ°å›¾ API åŠ è½½å®Œæˆ');
                    // Trigger map initialization if already in map view
                    if (typeof window.amapReadyCallback === 'function') {
                        window.amapReadyCallback();
                    }
                };
                script.onerror = function() {
                    console.error('é«˜å¾·åœ°å›¾ API åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®');
                };
                document.head.appendChild(script);
            } else {
                console.warn('é«˜å¾·åœ°å›¾ API Key æœªé…ç½®ï¼Œè¯·åœ¨ config.js ä¸­è®¾ç½® AMAP_API_KEY');
            }
        })();
    </script>
    <!-- js-yaml for YAML parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>OB Cloud å…¨çƒåœ°åŸŸåˆ†å¸ƒ</h1>
            <div class="header-controls">
                <div class="view-mode-selector">
                    <button class="view-mode-btn active" data-mode="globe" title="3D åœ°çƒè§†å›¾">
                        <span>ğŸŒ</span> Globe
                    </button>
                    <button class="view-mode-btn" data-mode="map" title="å¹³é“ºåœ°å›¾è§†å›¾">
                        <span>ğŸ—ºï¸</span> Map
                    </button>
                    <button class="view-mode-btn" data-mode="table" title="åˆ—è¡¨è§†å›¾">
                        <span>ğŸ“‹</span> Table
                    </button>
                </div>
                <div class="filters">
                    <select id="cloudProviderFilter" class="filter-select">
                        <option value="">æ‰€æœ‰äº‘å‚å•†</option>
                    </select>
                    <select id="regionFilter" class="filter-select">
                        <option value="">æ‰€æœ‰åŒºåŸŸ</option>
                    </select>
                </div>
            </div>
        </header>

        <main>
            <div class="main-content">
                <!-- Globe View -->
                <div id="globe-view" class="view-container active">
                    <div id="globe-canvas"></div>
                    <div id="globe-loading" class="globe-loading">
                        <div class="loading-spinner"></div>
                        <div class="loading-text">åœ°å›¾èµ„æºåŠ è½½ä¸­...</div>
                    </div>
                    <div class="legend" id="globe-legend">
                        <div class="legend-title">äº‘å‚å•†</div>
                    </div>
                </div>

                <!-- Map View -->
                <div id="map-view" class="view-container">
                    <div id="map"></div>
                </div>

                <!-- Table View -->
                <div id="table-view" class="view-container">
                    <div class="table-container">
                        <table id="regions-table">
                            <thead>
                                <tr>
                                    <th>äº‘å‚å•†</th>
                                    <th>åœ°åŸŸ</th>
                                    <th>åœ°åŸŸä»£ç </th>
                                    <th>å¯ç”¨åŒºæ•°é‡</th>
                                    <th>å¼€æœæ—¥æœŸ</th>
                                    <th>æ”¯æŒçš„æ¸ é“</th>
                                </tr>
                            </thead>
                            <tbody id="regions-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Region Info Sidebar -->
            <aside id="region-info-sidebar" class="info-sidebar">
                <div class="sidebar-header">
                    <h2>åœ°åŸŸä¿¡æ¯</h2>
                </div>
                <div id="region-info-content" class="sidebar-content">
                    <div class="empty-state">
                        <p>ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°ç‚¹æŸ¥çœ‹åœ°åŸŸè¯¦ç»†ä¿¡æ¯</p>
                    </div>
                </div>
            </aside>

            <!-- Overlapping Markers Popup -->
            <div id="overlapping-markers-popup" class="overlapping-popup hidden">
                <div class="popup-header">
                    <h3>é€‰æ‹©åœ°åŸŸ</h3>
                    <button class="popup-close-btn" id="close-overlapping-popup">Ã—</button>
                </div>
                <div class="popup-content" id="overlapping-markers-list">
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
</body>
</html>

